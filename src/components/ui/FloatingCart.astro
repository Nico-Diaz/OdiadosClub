<div id="cart-container" class="cart-wrapper hidden">
    <div class="cart-summary">
        <span class="font-gothic text-xl">TOTAL: $<span id="cart-total">0</span></span>
        <button id="btn-checkout" class="btn-checkout">CONFIRMAR PEDIDO</button>
    </div>
</div>

<script>
    
    import { cartItems } from '../../store/cart';

    const container = document.getElementById('cart-container');
    const totalSpan = document.getElementById('cart-total');
    const checkoutBtn = document.getElementById('btn-checkout');

    // Escuchamos cambios en el carrito
    cartItems.subscribe(items  => {
        if (items.length > 0) {
            container?.classList.remove('hidden');
            // Calculamos total
            const total = items.reduce((acc, item) => acc + (item.price * item.quantity), 0);
            if (totalSpan) totalSpan.innerText = total.toString();
        } else {
            container?.classList.add('hidden');
        }
    });

    // Lógica de "Backend" (Enviar pedido)
    checkoutBtn?.addEventListener('click', async () => {
        const items = cartItems.get();
        
        try {
            // AQUI LLAMAMOS A TU BACKEND
            const response = await fetch('/api/order', {
                method: 'POST',
                body: JSON.stringify({ items }),
            });

            const data = await response.json();
            
            if (data.success) {
                alert(`Pedido #${data.orderId} recibido en cocina. ¡Prepárate!`);
                cartItems.set([]); // Limpiar carrito
            }
        } catch (error) {
            alert('Error al enviar el pedido');
        }
    });
</script>

<style>
    .cart-wrapper {
        position: fixed;
        bottom: 20px;
        left: 50%;
        transform: translateX(-50%);
        width: 90%;
        max-width: 400px;
        z-index: 1000;
        animation: slideUp 0.3s ease-out;
    }

    .hidden { display: none; }

    .cart-summary {
        background-color: var(--color-red);
        color: var(--color-black);
        padding: 1rem;
        display: flex;
        justify-content: space-between;
        align-items: center;
        border: 2px solid var(--color-black);
        box-shadow: 0 10px 20px rgba(0,0,0,0.5);
    }

    .btn-checkout {
        background-color: var(--color-black);
        color: var(--color-white);
        border: none;
        padding: 0.5rem 1rem;
        font-family: var(--font-gothic);
        font-size: 1.2rem;
        cursor: pointer;
    }

    @keyframes slideUp {
        from { transform: translate(-50%, 100%); }
        to { transform: translate(-50%, 0); }
    }
</style>